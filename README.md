# üé• CS2 GSI ‚Üí OBS Router

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è POV-–∫–∞–º–µ—Ä –≤ OBS Studio –ø–æ –¥–∞–Ω–Ω—ã–º Game State Integration (GSI) –∏–∑ Counter-Strike 2.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –ø–æ `steamid` –∏–∑ GSI –∏ –≤–∫–ª—é—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ–≥–æ –∫–∞–º–µ—Ä—É.
- –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ OBS WebSocket (OBS 28+).
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `mapping.json` –∏–ª–∏ –∞–≤—Ç–æ-–ø—Ä–∞–≤–∏–ª–∞ `POV_<steamid>`.
- –ê–Ω—Ç–∏–¥—Ä–µ–±–µ–∑–≥ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π, healthcheck, —Ä—É—á–Ω–æ–π override.

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Node.js 18+
- OBS Studio 28+
- –í–∫–ª—é—á—ë–Ω–Ω—ã–π OBS WebSocket (–ø–æ—Ä—Ç 4455, –ø–∞—Ä–æ–ª—å).

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
git clone <your-repo> cs2-obs-router
cd cs2-obs-router
npm install
```

## üéõ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OBS
1. –í OBS: `Tools ‚Üí WebSocket Server Settings` ‚Üí –≤–∫–ª—é—á–∏—Ç—å —Å–µ—Ä–≤–µ—Ä, –ø–æ—Ä—Ç 4455, –∑–∞–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å.
2. –°–æ–∑–¥–∞—Ç—å —Å—Ü–µ–Ω—É `POV_ROUTER`.
3. –î–æ–±–∞–≤–∏—Ç—å POV-–∏—Å—Ç–æ—á–Ω–∏–∫–∏:
   - –ª–∏–±–æ –Ω–∞–∑–≤–∞—Ç—å –∏—Ö `POV_<steamid64>`,
   - –ª–∏–±–æ —Å–æ–∑–¥–∞—Ç—å `mapping.json` —Å —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º–∏.

–ü—Ä–∏–º–µ—Ä `mapping.json`:
```json
{
  "76561198000000001": "POV_Player1",
  "76561198000000002": "POV_Player2"
}
```

## üéÆ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CS2 (GSI)
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.../game/csgo/cfg/gamestate_integration_obsrouter.cfg` —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏:
```ini
"Gamestate Integration OBS Router"
{
  "uri" "http://127.0.0.1:3000/gsi"
  "timeout" "1.0"
  "buffer"  "0.1"
  "throttle" "0.1"
  "heartbeat" "5.0"
  "data"
  {
    "provider" "1"
    "player_id" "1"
    "player_state" "1"
    "player_position" "1"
    "allplayers_id" "1"
    "allplayers_position" "1"
  }
}
```

> –ï—Å–ª–∏ CS2 –∏ OBS –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ü–ö: —É–∫–∞–∂–∏ –≤ `uri` IP —Å—Ç—Ä–∏–º–µ—Ä—Å–∫–æ–≥–æ –ü–ö –≤–º–µ—Å—Ç–æ `127.0.0.1`.

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫
–ß–µ—Ä–µ–∑ npm-—Å–∫—Ä–∏–ø—Ç (Windows/macOS/Linux –æ–¥–∏–Ω–∞–∫–æ–≤–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `cross-env`):
```bash
npm run start --silent
```
–∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:
```bash
OBS_PASS=superpass node server.mjs
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `OBS_URL` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `ws://127.0.0.1:4455`)
- `OBS_PASS` ‚Äî –ø–∞—Ä–æ–ª—å OBS WebSocket
- `ROUTER_SCENE` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `POV_ROUTER`)
- `PORT` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `3000`)
- `DEFAULT_SOURCE` ‚Äî –∏–º—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–µ—Å–ª–∏ —Ü–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞)
- `MIN_SWITCH_INTERVAL_MS` ‚Äî –º–∏–Ω–∏–º—É–º –º–µ–∂–¥—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è–º–∏ (–º—Å)
- `GSI_TOKEN` ‚Äî –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –ø—Ä–æ—Å—Ç–æ–π —Ç–æ–∫–µ–Ω –¥–ª—è –∑–∞—â–∏—Ç—ã `/gsi`

## üåê HTTP API
- `POST /gsi` ‚Äî –≤—Ö–æ–¥ GSI (CS2 ‚Üí —Å—é–¥–∞)
- `GET /health` ‚Äî —Å—Ç–∞—Ç—É—Å JSON
- `POST /force/:source` ‚Äî —Ä—É—á–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
- `POST /reload-mapping` ‚Äî –≥–æ—Ä—è—á–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ `mapping.json`

–¢–µ—Å—Ç –±–µ–∑ –∏–≥—Ä—ã:
```bash
curl -X POST http://127.0.0.1:3000/gsi \
 -H "Content-Type: application/json" \
 -d '{"player":{"steamid":"76561198000000001"}}'
```

## üõ° –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ–¥ PM2 –∏–ª–∏ systemd. –°–ª–µ–¥–∏—Ç—å –∑–∞ `/health`. –î–ª—è —Å–µ—Ç–µ–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –≤–∫–ª—é—á–∏—Ç–µ `GSI_TOKEN` –∏ —Ñ–∞–µ—Ä–≤–æ–ª.

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è
MIT
